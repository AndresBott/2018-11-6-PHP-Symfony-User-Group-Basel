# -*- mode: ruby -*-
# vi: set ft=ruby :


Vagrant.configure("2") do |config|
    # https://docs.vagrantup.com.
    # boxes at https://vagrantcloud.com/search.
    # config.vm.box = "debian/stretch64"

    puts "Debian/stretch64"

    config.vm.define "php-meetup-mysql" do |os|
      #os.vm.box = "debian/stretch64"
      os.vm.box = "debian/contrib-stretch64"

        os.vm.provider "virtualbox" do |v|
            # set the name of the VM
            v.name = "php-meetup-mysql"

            # use a linked clone of the imported machine
            v.linked_clone = true

            # use VBoxManage to make vm setting
            #v.customize ["modifyvm", :id, "--cpuexecutioncap", "50"]
            v.customize ["modifyvm", :id, "--ioapic", "on"]
            v.memory = 1024
            v.cpus = 1
        end
        # os.vm.provision "shell", path: "php-fpm.bash"

    end

    # config.vm.network "forwarded_port", guest: 80, host: 8080

    config.vm.network :private_network, ip: "10.0.0.12"
    config.vm.hostname = "php-meetup-mysql"
    #config.vm.network "public_network"

    # mount project src code
    # will be bind mounted in the guest later on
    config.vm.synced_folder "../../src/", "/host_project"

    # Disable the new default behavior introduced in Vagrant 1.7, to
    # ensure that all Vagrant machines will use the same SSH key pair.
    # See https://github.com/mitchellh/vagrant/issues/5005
    # added by default ansible
    config.ssh.insert_key = false
    config.vm.provision "shell", path: "setup.bash"

end


